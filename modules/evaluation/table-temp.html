<style>
.col-sm-1,.col-sm-2,.col-sm-3,.col-sm-4,.col-sm-5.col-sm-6,.col-sm-7,.col-sm-8,.col-sm-9,.col-sm-10,.col-sm-11,.col-sm-12{
    padding: unset;
}
    .header {
        text-align: center;
        font-size: larger;
        font-weight: 600;
        padding: 10px 0px;
    }

    .indicators {
        text-align: center;
        border-left: 1px solid #ddd;
    }


    .tableRow {
        display: flex;
        align-items: center;
    }

    .tableCell {
        vertical-align: center;
        text-align: center;
        flex-grow: 1;
    }
    .indicator{
        border-top: 1px solid #ddd;
        display: flex;
        align-items: stretch;
    }
    .points,.score,.remark,.completionMark,.gist{
        border-left: 1px solid #ddd;
    }
    .index,.points,.score,.grade,.completionMark, .gist{
        display: flex;
        align-items: center;
        justify-content: center;
    }
    .remark{
        display: flex;
        align-items: stretch;
    }
    .scaleMarks{
        border-top: 1px solid #ddd;
        border-left: 1px solid #ddd;
        border-right: 1px solid #ddd;
        display: flex;
    }
    .scaleMark{
        display: flex;
        flex-direction: column;
    }
    .scaleMarkTitle{
        /*border: 1px solid #ddd;*/
        text-align: left;
        padding-left: 5px;
    }
    .gist{
        cursor: pointer;
        color: #0F71EE;
    }
.scaleMarkTitle div{
    padding: 5px;
}
</style>
<ul id="head" class="list-group row" style="margin-bottom: 0px;">
    <li class="list-group-item header col-sm-12">
        <div class="col-sm-1">
            <div class="col-sm-12">
                考核指标
            </div>
        </div>
        <div class="col-sm-11">
            <div class="col-sm-12"    >
                <div class="col-sm-1">
                    序号
                </div>
                <div class="col-sm-1">考核要点</div>
                <div class="col-sm-1">分值</div>
                <div class="col-sm-7">
                    <div class="col-sm-12">
                        <div class="col-sm-8">评分标准</div>
                        <div class="col-sm-2">考核完成情况</div>
                        <div class="col-sm-2">考核依据</div>
                    </div>
                </div>
                <div class="col-sm-1">
                    评分：<span id="sumSpan">0</span> 分
                <input id="sum" type="hidden">
                </div>
                <div class="col-sm-1">备注</div>
            </div>
        </div>
    </li>
</ul>
<ul id="center" class="list-group row" style="overflow: auto;margin-bottom: 0px;height: 500px;" >
<% for(var i = 0; i < evaluations.length; i++) { %>
<% var evaluation = evaluations[i] %>
<li class="list-group-item center col-sm-12" style="padding: 0px">
        <div class="tableRow">
            <div class="col-sm-1">
            <div class="evaluationTitle tableCell col-sm-12">
                    <p><%=evaluation.evaluationTitle%></p>
            </div>
            </div>

            <div class="indicators tableCell col-sm-11">
                    <% for(var j = 0; j < evaluation.indicators.length; j++) { %>
                <% var indicator = evaluation.indicators[j] %>
                <div class="indicator col-sm-12" <% if(j==0){%> style="border-top: 0px;"   <% } %>   >
                    <div class="index col-sm-1">
                        <%=indicator.index%>
                    </div>
                    <div class="points col-sm-1"><%=indicator.points%></div>
                    <div class="score col-sm-1"><%=indicator.score%></div>
                    <div class="scaleMark col-sm-7">
                        <% for(var k = 0; k < indicator.scaleMarks.length; k++) { %>
                        <% var scaleMark = indicator.scaleMarks[k] %>
                        <div class="col-sm-12 scaleMarks" <% if(k==0){%> style="border-top: 0px;"   <% } %>  >
                        <div class="scaleMarkTitle col-sm-8"><div ><%=scaleMark.scaleMarkTitle%></div></div>
                            <div class="completionMark col-sm-2">
                                <!--<%=scaleMark.completionMark%>-->
                                <select name="completionMark" style="margin: 5px 5px;cursor: pointer;" class="form-control" title="完成情况 ">
                                    <option value="0">未完成</option>
                                    <option value="20">20%</option>
                                    <option value="40">40%</option>
                                    <option value="60">60%</option>
                                    <option value="80">80%</option>
                                    <option value="100">已完成</option>
                                </select>
                            </div>
                            <div class="gist col-sm-2" title="<%=scaleMark.gist.title%>"><%=scaleMark.gist.title%></div>
                        </div>
                        <% }%>
                    </div>
                        <div style="padding: 0px 5px" class="grade col-sm-1" data-score="<%=indicator.score%>">
                            <!--<%=indicator.grade%>-->
                            <% if(i != evaluations.length-1){%>
                            <select name="grade" style="margin: 0px 5px;cursor: pointer;" class="form-control" title="<%=indicator.points%> ">
                                <% for(var grade = indicator.score; grade > 0; grade--) { %>
                                <option value="<%=grade%>"><%=grade%></option>
                                <option value="<%=grade-0.5%>"><%=grade-0.5%></option>
                                <% }%>
                                <option value="0">0</option>
                            </select>
                            <% }%>
                            <%  if(i == evaluations.length-1){%>
                            <input class="form-control"style="margin: 0px 5px;" name="grade" placeholder="请输入扣分值">
                            <% }%>
                        </div>
                        <div style="padding: 5px 5px" class="remark col-sm-1">
                            <!--<%=indicator.remark%>-->
                            <textarea style="resize:none" class="form-control textarea" name="remark" placeholder="请输入备注"></textarea>
                        </div>
                </div>
                <% }%>
            </div>
        </div>

</li>
<% }%>
</ul>
<script>
    $(window).resize(function () {
        fitHeight()
    })
    fitHeight()
    $("[name='grade']").change(function () {
        sumGrade()
    });

    function fitHeight() {
        $("#center").height($("body").height()-$("#head").height()-250)
    }

    function sumGrade() {
            var sum = 100;
        $("[name='grade']").each(function () {
            var one = $(this).val()||0;
            sum -= one;
        })
        if (sum < 0) {
            sum=0;
        }
        $("#sum").val(sum);
        $("#sumSpan").text(sum);
    }
</script>